import{W as e,p as l,V as a,k as s,o as t,c as n,w as o,g as u,b as i,q as r,f as c,t as d,j as p,D as v,a as x,h as f,F as m,d as y,z as k,v as g,u as _,Y as h,Z as b,K as j,A as w,H as F}from"./index-e2f60810.js";import{_ as M}from"./uni-card.0cb65f05.js";import{o as C,c as I,z as D,B,r as N}from"./api.bd94d21b.js";import{_ as O,a as z}from"./uni-popup.91bf8749.js";import{_ as A}from"./addRecords.01534e14.js";import{_ as E}from"./abButton.12c12e99.js";import"./abMiniButton.a946a698.js";import"./dayjs.min.0950a910.js";const L={__name:"orderInfo",setup(L){let P=e("orderId"),T=e("userOrderId");const q=l({}),H=["正常辣","微辣","特辣"];C((async e=>{e.id&&(P=e.id);let l=await I({id:P});q.value=l[0];let a=await D({orderId:P||"dfs2345"});R.value=a}));const K=l(""),R=l([]);a((()=>{if(!s())try{document.getElementsByClassName("uni-page-head-btn")[0].style.display="none"}catch(e){}console.log(window)}));const V=l(null),W=async()=>{if(K.value)return V.value.open();let e=await B({orderId:P});console.log(e),K.value=e,V.value.open()},Y=()=>{console.log(K.value),k({filePath:K.value,success:e=>{g({title:"保存成功",icon:"success",mask:!0}),V.value.close()},fail:e=>{console.log(e),_({title:"失败",content:e.errMsg,showCancel:!0,success:({confirm:e,cancel:l})=>{}}),V.value.close()}})},Z=()=>{h("userOrderId"),b({url:"/pages/orderDetail/index"})};return(e,l)=>{const a=j("abEmpty"),k=N(w("uni-card"),M),g=u,_=F,h=N(w("uni-popup-dialog"),O),b=N(w("uni-popup"),z);return t(),n(g,null,{default:o((()=>[!q.value.isFinish&&q.value.takeMeal?(t(),i("div",{key:0,class:"px-[12px] pt-[12px] text-center"},[r("p",null,[c(" 订单正在准备中，您的取餐号是:"),r("span",{class:"text-text3 text-16 font-bold"},d(q.value.takeMeal),1)])])):p("",!0),v(s)()?(t(),i("div",{key:1,class:"p-[12px] px-[16px]"},[x(E,{icon:"link",onClick:W},{default:o((()=>[c("为此订单生成网址二维码")])),_:1})])):p("",!0),x(k,null,{default:o((()=>{var e,l;return[r("div",{class:"text-12"},[r("div",{class:"grid grid-cols-2"},[r("span",null,"订单名："+d(q.value.orderName),1),r("span",null,[c("订单状态："),r("span",{class:f(q.value.isFinish?"text-text5":"text-text3")},d(q.value.isFinish?"已完成":"未完成"),3)]),r("span",null,"口味："+d(H[q.value.taste-1]),1),q.value.desk?(t(),i("span",{key:0},"桌位："+d(q.value.desk),1)):p("",!0),r("span",null,"是否打包："+d(q.value.isPack?"打包":"未打包"),1),r("span",null,"是否有加菜："+d(q.value.isAddMenu?"有":"无"),1),r("span",null,"下单方式："+d(q.value.userOperation?"客户自助":"管理员"),1),r("span",null,[c("订单金额："),r("span",{class:"text-text3 text-14"},d(null==(e=q.value.totalMoney)?void 0:e.toFixed(2)),1)]),q.value.isFinish?(t(),i("span",{key:1},[c("实收金额："),r("span",{class:"text-text3 text-14"},d((q.value.actualMoney||q.value.totalMoney).toFixed(2)),1)])):p("",!0),r("span",null,"商品总数："+d(q.value.totalCount),1),q.value.deviceNo&&v(s)()?(t(),i("span",{key:2},"设备："+d(q.value.deviceNo),1)):p("",!0)]),r("p",null,"订单ID："+d(q.value.id),1),r("p",null,"创建时间："+d(q.value.showTime),1),r("p",{class:"text-16 text-center my-[12px]"},"商品明细清单"),(null==(l=q.value.orderDetail)?void 0:l.length)?(t(),i("div",{key:0},[r("ul",null,[r("li",{class:"grid grid-cols-4 text-center py-[4px] font-bold"},[r("span",null,"名称"),r("span",null,"单价"),r("span",null,"数量"),r("span",null,"小记")]),(t(!0),i(m,null,y(q.value.orderDetail,(e=>(t(),i("li",{key:e.id,class:"grid grid-cols-4 text-center py-[4px]",style:{"border-bottom":"1px solid var(--border_c)"}},[r("span",null,d(e.name),1),r("span",null,d(e.price.toFixed(2)),1),r("span",null,d(e.count),1),r("span",{class:"text-text3"},d((e.price*e.count).toFixed(2)),1)])))),128))])])):(t(),n(a,{key:1,text:"暂无数据"})),R.value.length>1?(t(),n(A,{key:2,recordsList:R.value},null,8,["recordsList"])):p("",!0)])]})),_:1}),v(T)&&!v(s)()?(t(),n(g,{key:2,class:"m-[14px]"},{default:o((()=>[x(E,{onClick:Z},{default:o((()=>[c("继续添加订单")])),_:1})])),_:1})):p("",!0),x(b,{ref_key:"popup2",ref:V,type:"dialog"},{default:o((()=>[x(h,{title:"订单二维码",confirmText:"保存二维码",duration:2e3,"before-close":!0,onClose:l[0]||(l[0]=e=>V.value.close()),onConfirm:Y},{default:o((()=>[r("div",{class:"flex justify-center w-full"},[x(_,{src:K.value,class:"w-full"},null,8,["src"])])])),_:1})])),_:1},512)])),_:1})}}};export{L as default};
