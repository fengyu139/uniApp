import{p as a,m as e,J as s,s as t,o as l,b as i,q as n,a as u,w as o,v as c,g as r,f as m,F as p,d,c as f,e as v,K as _,N as b,x as g,L as x,u as j,O as y,Q as k}from"./index-42efb9d3.js";import{_ as C}from"./uni-card.a76374c6.js";import{b as h,m as w,r as I,h as L}from"./api.e8dc4ec0.js";import{s as M}from"./globalStore.42b6bcf6.js";import{_ as V}from"./abMiniButton.34f7bb56.js";import{_ as B}from"./abButton.712ead7f.js";import{_ as $}from"./abPicker.d07c6321.js";import{i as q}from"./imgErr.8cf36142.js";import"./_plugin-vue_export-helper.1b428a4d.js";const D={__name:"manage",setup(D){const E=a(0),F=e([{text:"全部",value:0},...M.value]),J=a([]);s((async()=>{(async()=>{let a={};E.value&&(a.type=E.value);let e=await w(a);J.value=e,t()})()}));h((async()=>{E.value=0;let a=await w({type:E.value});J.value=a,t()}));const K=()=>{c({url:"/pages/manage/addMenu"})};return(a,e)=>{const s=r,t=I(g("uni-card"),C);return l(),i("div",{class:""},[n("div",{class:"p-[13px] flex justify-between items-center"},[u($,{class:"w-3/5",modelValue:E.value,"onUpdate:modelValue":e[0]||(e[0]=a=>E.value=a),selectList:F,label:"选择分类"},null,8,["modelValue","selectList"]),u(B,{onClick:K,class:"w-1/3",icon:"plus"},{default:o((()=>[m("新增")])),_:1})]),u(s,null,{default:o((()=>[(l(!0),i(p,null,d(J.value,(a=>(l(),f(t,{title:a.name,thumbnail:a.picImg||_(q),"sub-title":F.find((e=>e.value==a.type)).text,extra:`价格：${a.price}`,onClick:e=>{return s=e,t=a.picImg,void("title"==s&&b({urls:[t],success:a=>{},fail:a=>{}}));var s,t}},{default:o((()=>[u(s,{class:"card-actions flex py-[6px] justify-around"},{default:o((()=>[u(V,{plain:"",onClick:v((e=>(a=>{y().globalData.menuItem=a,c({url:"/pages/manage/addMenu",success:e=>{setTimeout((()=>{k("menuItem",a)}),200)}})})(a)),["stop"])},{default:o((()=>[m("修改")])),_:2},1032,["onClick"]),u(V,{plain:"",type:"warn",icon:"trash",iconColor:"#fa2c19",onClick:v((e=>(async a=>{x({title:"提示",content:`确定删除${a.name}吗？`,showCancel:!0,success:({confirm:e,cancel:s})=>{e&&L({id:a.id}).then((e=>{j({title:"删除成功"}),J.value=J.value.filter((e=>e.id!=a.id))})).catch((a=>{j({title:"删除失败"+a})}))}})})(a)),["stop"])},{default:o((()=>[m("删除")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1032,["title","thumbnail","sub-title","extra","onClick"])))),256))])),_:1})])}}};export{D as default};
