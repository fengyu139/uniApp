import{p as a,m as e,A as s,s as t,o as l,b as i,q as n,a as u,w as o,x as c,g as r,f as m,F as p,d,c as f,e as v,B as b,D as y,y as _,u as g,v as x,E as j,G as k}from"./index-aada019a.js";import{_ as C}from"./uni-card.36e89123.js";import{b as w,m as h,r as I,i as B}from"./api.28706665.js";import{s as M}from"./globalStore.081ccd10.js";import{_ as V}from"./abMiniButton.975333d2.js";import{_ as D}from"./abButton.e151e408.js";import{_ as E}from"./abPicker.1c92b03e.js";import{i as L}from"./imgErr.8cf36142.js";const $={__name:"manage",setup($){const q=a(0),A=e([{text:"全部",value:0},...M.value]),F=a([]);s((async()=>{(async()=>{let a={};q.value&&(a.type=q.value);let e=await h(a);F.value=e,t()})()}));w((async()=>{q.value=0;let a=await h({type:q.value});F.value=a,t()}));const G=()=>{c({url:"/pages/manage/addMenu"})};return(a,e)=>{const s=r,t=I(_("uni-card"),C);return l(),i("div",{class:""},[n("div",{class:"p-[13px] flex justify-between items-center"},[u(E,{class:"w-3/5",modelValue:q.value,"onUpdate:modelValue":e[0]||(e[0]=a=>q.value=a),selectList:A,label:"选择分类"},null,8,["modelValue","selectList"]),u(D,{onClick:G,class:"w-1/3",icon:"plus"},{default:o((()=>[m("新增")])),_:1})]),u(s,null,{default:o((()=>[(l(!0),i(p,null,d(F.value,(a=>(l(),f(t,{title:a.name,thumbnail:a.picImg||b(L),"sub-title":A.find((e=>e.value==a.type)).text,extra:`价格：${a.price}`,onClick:e=>{return s=e,t=a.picImg,void("title"==s&&y({urls:[t],success:a=>{},fail:a=>{}}));var s,t}},{default:o((()=>[u(s,{class:"card-actions flex py-[6px] justify-around"},{default:o((()=>[u(V,{plain:"",onClick:v((e=>(a=>{j().globalData.menuItem=a,c({url:"/pages/manage/addMenu",success:e=>{setTimeout((()=>{k("menuItem",a)}),200)}})})(a)),["stop"])},{default:o((()=>[m("修改")])),_:2},1032,["onClick"]),u(V,{plain:"",type:"warn",icon:"trash",iconColor:"#fa2c19",onClick:v((e=>(async a=>{g({title:"提示",content:`确定删除${a.name}吗？`,showCancel:!0,success:({confirm:e,cancel:s})=>{e&&B({id:a.id}).then((e=>{x({title:"删除成功"}),F.value=F.value.filter((e=>e.id!=a.id))})).catch((a=>{x({title:"删除失败"+a})}))}})})(a)),["stop"])},{default:o((()=>[m("删除")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1032,["title","thumbnail","sub-title","extra","onClick"])))),256))])),_:1})])}}};export{$ as default};
