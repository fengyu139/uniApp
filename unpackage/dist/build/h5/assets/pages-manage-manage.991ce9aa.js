import{p as a,m as e,B as s,s as t,o as l,b as i,q as n,a as u,w as o,y as c,g as r,f as m,F as p,d,c as f,e as v,C as b,E as y,z as _,u as g,v as j,G as x,H as C}from"./index-6fc68066.js";import{_ as k}from"./uni-card.f0684529.js";import{b as w,m as h,r as I,i as B}from"./api.b4337b42.js";import{s as M}from"./globalStore.e266ec6a.js";import{_ as V}from"./abMiniButton.c3a227d8.js";import{_ as E}from"./abButton.182468a8.js";import{_ as L}from"./abPicker.d84521fd.js";import{i as $}from"./imgErr.8cf36142.js";const q={__name:"manage",setup(q){const z=a(0),D=e([{text:"全部",value:0},...M.value]),F=a([]);s((async()=>{(async()=>{let a={};z.value&&(a.type=z.value);let e=await h(a);F.value=e,t()})()}));w((async()=>{z.value=0;let a=await h({type:z.value});F.value=a,t()}));const G=()=>{c({url:"/pages/manage/addMenu"})};return(a,e)=>{const s=r,t=I(_("uni-card"),k);return l(),i("div",{class:""},[n("div",{class:"p-[13px] flex justify-between items-center"},[u(L,{class:"w-3/5",modelValue:z.value,"onUpdate:modelValue":e[0]||(e[0]=a=>z.value=a),selectList:D,label:"选择分类"},null,8,["modelValue","selectList"]),u(E,{onClick:G,class:"w-1/3",icon:"plus"},{default:o((()=>[m("新增")])),_:1})]),u(s,null,{default:o((()=>[(l(!0),i(p,null,d(F.value,(a=>(l(),f(t,{title:a.name,thumbnail:a.picImg||b($),"sub-title":D.find((e=>e.value==a.type)).text,extra:`价格：${a.price}`,onClick:e=>{return s=e,t=a.picImg,void("title"==s&&y({urls:[t],success:a=>{},fail:a=>{}}));var s,t}},{default:o((()=>[u(s,{class:"card-actions flex py-[6px] justify-around"},{default:o((()=>[u(V,{plain:"",onClick:v((e=>(a=>{x().globalData.menuItem=a,c({url:"/pages/manage/addMenu",success:e=>{setTimeout((()=>{C("menuItem",a)}),200)}})})(a)),["stop"])},{default:o((()=>[m("修改")])),_:2},1032,["onClick"]),u(V,{plain:"",type:"warn",icon:"trash",iconColor:"#fa2c19",onClick:v((e=>(async a=>{g({title:"提示",content:`确定删除${a.name}吗？`,showCancel:!0,success:({confirm:e,cancel:s})=>{e&&B({id:a.id}).then((e=>{j({title:"删除成功"}),F.value=F.value.filter((e=>e.id!=a.id))})).catch((a=>{j({title:"删除失败"+a})}))}})})(a)),["stop"])},{default:o((()=>[m("删除")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1032,["title","thumbnail","sub-title","extra","onClick"])))),256))])),_:1})])}}};export{q as default};
