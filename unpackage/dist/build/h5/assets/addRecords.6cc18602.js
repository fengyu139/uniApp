import{N as e,A as s,o as t,c as i,w as a,a as l,h as n,r as o,j as c,f as h,t as r,n as p,a1 as d,i as u,g as m,b as f,q as x,F as y,d as g,D as _,k,e as w,v as b}from"./index-db00d276.js";import{_ as v,r as C,i as O,z as S}from"./api.f9490d4f.js";import{_ as A}from"./abMiniButton.cc38c446.js";import{d as $}from"./dayjs.min.75d5deec.js";const B=v({name:"uniCollapseItem",props:{title:{type:String,default:""},name:{type:[Number,String],default:""},disabled:{type:Boolean,default:!1},showAnimation:{type:Boolean,default:!0},open:{type:Boolean,default:!1},thumb:{type:String,default:""},titleBorder:{type:String,default:"auto"},border:{type:Boolean,default:!0},showArrow:{type:Boolean,default:!0}},data:()=>({isOpen:!1,isheight:null,height:0,elId:`Uni_${Math.ceil(1e6*Math.random()).toString(36)}`,nameSync:0}),watch:{open(e){this.isOpen=e,this.onClick(e,"init")}},updated(e){this.$nextTick((()=>{this.init(!0)}))},created(){this.collapse=this.getCollapse(),this.oldHeight=0,this.onClick(this.open,"init")},unmounted(){this.__isUnmounted=!0,this.uninstall()},mounted(){this.collapse&&(""!==this.name?this.nameSync=this.name:this.nameSync=this.collapse.childrens.length+"",-1===this.collapse.names.indexOf(this.nameSync)?this.collapse.names.push(this.nameSync):console.warn(`name 值 ${this.nameSync} 重复`),-1===this.collapse.childrens.indexOf(this)&&this.collapse.childrens.push(this),this.init())},methods:{init(e){this.getCollapseHeight(e)},uninstall(){this.collapse&&(this.collapse.childrens.forEach(((e,s)=>{e===this&&this.collapse.childrens.splice(s,1)})),this.collapse.names.forEach(((e,s)=>{e===this.nameSync&&this.collapse.names.splice(s,1)})))},onClick(e,s){this.disabled||(this.isOpen=e,this.isOpen&&this.collapse&&this.collapse.setAccordion(this),"init"!==s&&this.collapse.onChange(e,this))},getCollapseHeight(s,t=0){e().in(this).select(`#${this.elId}`).fields({size:!0},(e=>{if(!(t>=10)){if(!e)return t++,void this.getCollapseHeight(!1,t);this.height=e.height,this.isheight=!0,s||this.onClick(this.isOpen,"init")}})).exec()},getNvueHwight(e){dom.getComponentRect(this.$refs["collapse--hook"],(s=>{if(s&&s.result&&s.size){if(this.height=s.size.height,this.isheight=!0,e)return;this.onClick(this.open,"init")}}))},getCollapse(e="uniCollapse"){let s=this.$parent,t=s.$options.name;for(;t!==e;){if(s=s.$parent,!s)return!1;t=s.$options.name}return s}}},[["render",function(e,f,x,y,g,_){const k=d,w=u,b=m,v=C(s("uni-icons"),O);return t(),i(b,{class:"uni-collapse-item"},{default:a((()=>[l(b,{onClick:f[0]||(f[0]=e=>_.onClick(!g.isOpen)),class:n(["uni-collapse-item__title",{"is-open":g.isOpen&&"auto"===x.titleBorder,"uni-collapse-item-border":"none"!==x.titleBorder}])},{default:a((()=>[l(b,{class:"uni-collapse-item__title-wrap"},{default:a((()=>[o(e.$slots,"title",{},(()=>[l(b,{class:n(["uni-collapse-item__title-box",{"is-disabled":x.disabled}])},{default:a((()=>[x.thumb?(t(),i(k,{key:0,src:x.thumb,class:"uni-collapse-item__title-img"},null,8,["src"])):c("",!0),l(w,{class:"uni-collapse-item__title-text"},{default:a((()=>[h(r(x.title),1)])),_:1})])),_:1},8,["class"])]),!0)])),_:3}),x.showArrow?(t(),i(b,{key:0,class:n([{"uni-collapse-item__title-arrow-active":g.isOpen,"uni-collapse-item--animation":!0===x.showAnimation},"uni-collapse-item__title-arrow"])},{default:a((()=>[l(v,{color:x.disabled?"#ddd":"#bbb",size:"14",type:"bottom"},null,8,["color"])])),_:1},8,["class"])):c("",!0)])),_:3},8,["class"]),l(b,{class:n(["uni-collapse-item__wrap",{"is--transition":x.showAnimation}]),style:p({height:(g.isOpen?g.height:0)+"px"})},{default:a((()=>[l(b,{id:g.elId,ref:"collapse--hook",class:n(["uni-collapse-item__wrap-content",{open:g.isheight,"uni-collapse-item--border":x.border&&g.isOpen}])},{default:a((()=>[o(e.$slots,"default",{},void 0,!0)])),_:3},8,["id","class"])])),_:3},8,["class","style"])])),_:3})}],["__scopeId","data-v-74f2d81a"]]);const V=v({name:"uniCollapse",emits:["change","activeItem","input","update:modelValue"],props:{value:{type:[String,Array],default:""},modelValue:{type:[String,Array],default:""},accordion:{type:[Boolean,String],default:!1}},data:()=>({}),computed:{dataValue(){let e="string"==typeof this.value&&""===this.value||Array.isArray(this.value)&&0===this.value.length;"string"==typeof this.modelValue&&""===this.modelValue||Array.isArray(this.modelValue)&&this.modelValue.length;return e?this.modelValue:this.value}},watch:{dataValue(e){this.setOpen(e)}},created(){this.childrens=[],this.names=[]},mounted(){this.$nextTick((()=>{this.setOpen(this.dataValue)}))},methods:{setOpen(e){let s="string"==typeof e,t=Array.isArray(e);this.childrens.forEach(((i,a)=>{if(s&&e===i.nameSync){if(!this.accordion)return void console.warn("accordion 属性为 false ,v-model 类型应该为 array");i.isOpen=!0}t&&e.forEach((e=>{if(e===i.nameSync){if(this.accordion)return void console.warn("accordion 属性为 true ,v-model 类型应该为 string");i.isOpen=!0}}))})),this.emit(e)},setAccordion(e){this.accordion&&this.childrens.forEach(((s,t)=>{e!==s&&(s.isOpen=!1)}))},resize(){this.childrens.forEach(((e,s)=>{e.getCollapseHeight()}))},onChange(e,s){let t=[];this.accordion?t=e?s.nameSync:"":this.childrens.forEach(((e,s)=>{e.isOpen&&t.push(e.nameSync)})),this.$emit("change",t),this.emit(t)},emit(e){this.$emit("input",e),this.$emit("update:modelValue",e)}}},[["render",function(e,s,l,n,c,h){const r=m;return t(),i(r,{class:"uni-collapse"},{default:a((()=>[o(e.$slots,"default",{},void 0,!0)])),_:3})}],["__scopeId","data-v-3a7c7163"]]),F={__name:"addRecords",props:["recordsList","showBtn"],setup(e){const o=e=>e.reduce(((e,s)=>e+s.count*s.price),0);return(p,d)=>{const u=m,v=C(s("uni-collapse-item"),B),O=C(s("uni-collapse"),V);return t(),f("div",null,[x("p",{class:"text-16 text-center my-[10px]"},"加菜记录"),l(O,{accordion:!0},{default:a((()=>[(t(!0),f(y,null,g(e.recordsList,((e,s)=>(t(),i(v,{key:s,class:"text-center","show-animation":!0},{title:a((()=>[l(u,{class:"py-[6px]"},{default:a((()=>[0==s?(t(),f("p",{key:0},[h(" 初始订单 : "),x("span",{class:"text-text3"},r(o(e.items).toFixed(2)),1)])):(t(),f("p",{key:1,class:"flex items-center py-[8px]"},[x("span",{class:"text-14 mr-[8px]"},[h("状态："),x("span",{class:n(e.isFinish?"text-text5":"text-text3")},r(e.isFinish?"已上菜":"准备中"),3)]),x("span",null,[h("第"+r(s)+"次加菜 :",1),x("span",{class:"text-text3 mr-[8px]"},r(o(e.items).toFixed(2)),1)]),x("span",{class:"ml-auto"},[!e.isFinish&&_(k)()?(t(),i(A,{key:0,onClick:w((s=>(async e=>{await S({id:e.id,isFinish:!0}),e.isFinish=!0,b({icon:"success",mask:!0})})(e)),["stop"])},{default:a((()=>[h("设置已上菜")])),_:2},1032,["onClick"])):c("",!0)])]))])),_:2},1024)])),default:a((()=>[l(u,null,{default:a((()=>[x("div",{class:"mb-[6px] text-[12px] text-gray-500"},[x("span",null,[h("下单时间 : "),x("span",null,r(_($)(e.createTime).format("YYYY-MM-DD HH:mm:ss")),1)])]),x("ul",null,[x("li",{class:"flex text-center text-[12px]"},[x("span",{class:"flex-1"},"菜名"),x("span",{class:"flex-1"},"单价"),x("span",{class:"flex-[0.5]"}),x("span",{class:"flex-1"}," 数量"),x("span",{class:"flex-[0.5]"}),x("span",{class:"flex-1"}," 小记 ")]),(t(!0),f(y,null,g(e.items,(e=>(t(),f("li",{key:e.type,class:"flex text-center text-[12px]"},[x("span",{class:"flex-1"},r(e.name),1),x("span",{class:"flex-1"},r(e.price),1),x("span",{class:"flex-[0.5]"},"*"),x("span",{class:"flex-1"},r(e.count),1),x("span",{class:"flex-[0.5]"},"="),x("span",{class:"flex-1 text-text3"},r((e.price*e.count).toFixed(2)),1)])))),128))])])),_:2},1024)])),_:2},1024)))),128))])),_:1})])}}};export{F as _};
