import{m as e,o as a,c as l,w as t,g as s,a as o,f as i,v as n,a5 as r,a6 as u,A as f}from"./index-e5e243ac.js";import{_ as m}from"./uni-easyinput.7a56ffff.js";import{E as c,v as p,r as d}from"./api.1c2959bd.js";import{_,a as y}from"./uni-forms.08c966eb.js";import{_ as j}from"./uni-file-picker.7118dbd2.js";import{_ as b}from"./abButton.a9b60730.js";import"./uni-cloud.es.f673658e.js";const x={__name:"addArticle",setup(x){const V=e({title:"",content:"",files:[]}),g=async()=>{if(!V.title)return void n({title:"请输入标题",icon:"none"});let e=0;for(const a of V.files)await w(e),e++;await c(V),n({title:"添加成功",icon:"success",mask:!0}),r({delta:1})},h=e=>{console.log(e),V.files.push(e.tempFilePaths[0])},k=e=>{V.files.splice(e.index,1)},w=async e=>new Promise(((a,l)=>{u({url:`${p.baseUrl}/upload`,fileType:"all",filePath:V.files[e],name:"image",success:({data:l,statusCode:t})=>{V.files[e]=JSON.parse(l).data,console.log(V.files),a(JSON.parse(l))},fail:e=>{console.log(e),l(e)}})}));return(e,n)=>{const r=d(f("uni-easyinput"),m),u=d(f("uni-forms-item"),_),c=d(f("uni-file-picker"),j),p=d(f("uni-forms"),y),x=s;return a(),l(x,{class:"p-[16px]"},{default:t((()=>[o(p,{ref:"myForm"},{default:t((()=>[o(u,{required:"",label:"标题:"},{default:t((()=>[o(r,{clearable:"",modelValue:V.title,"onUpdate:modelValue":n[0]||(n[0]=e=>V.title=e),type:"text",placeholder:"请输入标题"},null,8,["modelValue"])])),_:1}),o(u,{label:"内容:"},{default:t((()=>[o(r,{clearable:"",modelValue:V.content,"onUpdate:modelValue":n[1]||(n[1]=e=>V.content=e),type:"text",placeholder:"请输入内容"},null,8,["modelValue"])])),_:1}),o(u,{label:"附件:"},{default:t((()=>[o(c,{onSelect:h,onDelete:k,"file-mediatype":"all"})])),_:1})])),_:1},512),o(b,{onClick:g,icon:"plusempty"},{default:t((()=>[i("提 交")])),_:1})])),_:1})}}};export{x as default};
