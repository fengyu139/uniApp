import{p as a,m as e,C as s,E as l,s as t,$ as n,v as c,o as u,b as i,q as o,a as r,w as m,y as d,g as p,f,F as v,d as x,c as _,D as g,t as y,e as j,G as k,H as C,i as b,u as w,I as h,J as I}from"./index-3ff257ef.js";import{s as L}from"./globalStore.855714a3.js";import{_ as M,b as V,m as q,j as B}from"./api.ef60e80a.js";import{_ as D}from"./abMiniButton.d7103c17.js";import{_ as E}from"./abButton.e3ce1e21.js";import{_ as F}from"./abPicker.62425b6a.js";import{i as J}from"./imgErr.8cf36142.js";const S=M({__name:"manage",setup(M){const S=a(0),T=e([{text:"全部",value:0},...L.value]),$=a([]);s((async()=>{(async()=>{let a={};S.value&&(a.type=S.value);let e=await q(a);$.value=e,"{}"==JSON.stringify(a)&&l("menuList",e),t()})()}));V((async()=>{S.value=0;let a=await q({type:S.value});$.value=a,l("menuList",a),t()}));const G=()=>{d({url:"/pages/manage/addMenu"})};n("changeMenu",(a=>{S.value=0,q({type:S.value}).then((a=>{$.value=a,l("menuList",a)})),c({title:"成功",icon:"success",mask:!0})}));return(a,e)=>{const s=C,t=p,n=b;return u(),i("div",{class:""},[o("div",{class:"p-[13px] flex justify-between items-center"},[r(F,{class:"w-3/5",modelValue:S.value,"onUpdate:modelValue":e[0]||(e[0]=a=>S.value=a),selectList:T,label:"选择分类"},null,8,["modelValue","selectList"]),r(E,{onClick:G,class:"w-1/3",icon:"plus"},{default:m((()=>[f("新增")])),_:1})]),r(t,null,{default:m((()=>[(u(!0),i(v,null,x($.value,(a=>(u(),_(t,{key:a.id,class:"card-item"},{default:m((()=>[r(t,{class:"card-actions flex items-center"},{default:m((()=>[r(t,{class:"flex-[0.8]"},{default:m((()=>[r(s,{src:a.picImg||g(J),onClick:e=>{var s;(s=a.picImg)&&k({urls:[s],success:a=>{},fail:a=>{}})},mode:"scaleToFill",class:"w-[80rpx] h-[80rpx] rounded-[10rpx]"},null,8,["src","onClick"])])),_:2},1024),r(t,{class:"flex flex-col flex-1"},{default:m((()=>[r(n,null,{default:m((()=>[f(y(a.name),1)])),_:2},1024),r(n,{class:"text-12 text-text2"},{default:m((()=>[f(y(T.find((e=>e.value==a.type)).text),1)])),_:2},1024)])),_:2},1024),r(t,{class:"flex-1"},{default:m((()=>[o("span",null,[f("价格："),o("span",{class:"text-text3"},y(a.price),1)])])),_:2},1024),r(D,{plain:"",onClick:j((e=>(a=>{h().globalData.menuItem=a,d({url:"/pages/manage/addMenu",success:e=>{setTimeout((()=>{I("menuItem",a)}),200)}})})(a)),["stop"]),class:"mr-[16px]"},{default:m((()=>[f("修改")])),_:2},1032,["onClick"]),r(D,{plain:"",type:"warn",icon:"trash",iconColor:"#fa2c19",onClick:j((e=>(async a=>{w({title:"提示",content:`确定删除${a.name}吗？`,showCancel:!0,success:({confirm:e,cancel:s})=>{e&&B({id:a.id}).then((e=>{c({title:"删除成功"}),$.value=$.value.filter((e=>e.id!=a.id)),l("menuList",$.value)})).catch((a=>{c({title:"删除失败"+a})}))}})})(a)),["stop"])},{default:m((()=>[f("删除")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1})])}}},[["__scopeId","data-v-e8357edc"]]);export{S as default};
