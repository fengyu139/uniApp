import{p as a,m as e,C as s,E as l,s as t,$ as c,v as n,o as u,b as i,q as o,a as m,w as r,y as d,g as p,f,F as v,d as x,c as _,D as g,t as y,e as k,G as C,H as b,i as j,u as w,I as h,J as I}from"./index-bcd50104.js";import{s as L}from"./globalStore.e8593531.js";import{_ as M,b as V,m as B,j as D}from"./api.9400cdf0.js";import{_ as E}from"./abMiniButton.bec6b5f1.js";import{_ as F}from"./abButton.186f3981.js";import{_ as J}from"./abPicker.801ce734.js";import{i as S}from"./imgErr.8cf36142.js";const T=M({__name:"manage",setup(M){const T=a(0),$=e([{text:"全部",value:0},...L.value]),q=a([]);s((async()=>{(async()=>{let a={};T.value&&(a.type=T.value);let e=await B(a);q.value=e,"{}"==JSON.stringify(a)&&l("menuList",e),t()})()}));V((async()=>{T.value=0;let a=await B({type:T.value});q.value=a,l("menuList",a),t()}));const G=()=>{d({url:"/pages/manage/addMenu"})};c("changeMenu",(a=>{T.value=0,B({type:T.value}).then((a=>{q.value=a,l("menuList",a)})),n({title:"成功",icon:"success",mask:!0})}));return(a,e)=>{const s=b,t=p,c=j;return u(),i("div",{class:""},[o("div",{class:"p-[13px] flex justify-between items-center"},[m(J,{class:"w-3/5",modelValue:T.value,"onUpdate:modelValue":e[0]||(e[0]=a=>T.value=a),selectList:$,label:"选择分类"},null,8,["modelValue","selectList"]),m(F,{onClick:G,class:"w-1/3",icon:"plus"},{default:r((()=>[f("新增")])),_:1})]),m(t,null,{default:r((()=>[(u(!0),i(v,null,x(q.value,(a=>(u(),_(t,{key:a.id,class:"card-item"},{default:r((()=>[m(t,{class:"card-actions flex items-center"},{default:r((()=>[m(t,{class:"flex-[0.8]"},{default:r((()=>[m(s,{src:a.picImg||g(S),onClick:e=>{var s;(s=a.picImg)&&C({urls:[s],success:a=>{},fail:a=>{}})},mode:"scaleToFill",class:"w-[80rpx] h-[80rpx] rounded-[10rpx]"},null,8,["src","onClick"])])),_:2},1024),m(t,{class:"flex flex-col flex-1"},{default:r((()=>[m(c,null,{default:r((()=>[f(y(a.name),1)])),_:2},1024),m(c,{class:"text-12 text-text2"},{default:r((()=>[f(y($.find((e=>e.value==a.type)).text),1)])),_:2},1024)])),_:2},1024),m(t,{class:"flex-1"},{default:r((()=>[o("span",null,[f("价格："),o("span",{class:"text-text3"},y(a.price),1)])])),_:2},1024),m(E,{plain:"",onClick:k((e=>(a=>{h().globalData.menuItem=a,d({url:"/pages/manage/addMenu",success:e=>{setTimeout((()=>{I("menuItem",a)}),200)}})})(a)),["stop"]),class:"mr-[16px]"},{default:r((()=>[f("修改")])),_:2},1032,["onClick"]),m(E,{plain:"",type:"warn",icon:"trash",iconColor:"#fa2c19",onClick:k((e=>(async a=>{w({title:"提示",content:`确定删除${a.name}吗？`,showCancel:!0,success:({confirm:e,cancel:s})=>{e&&D({id:a.id}).then((e=>{n({title:"删除成功"}),q.value=q.value.filter((e=>e.id!=a.id)),l("menuList",q.value)})).catch((a=>{n({title:"删除失败"+a})}))}})})(a)),["stop"])},{default:r((()=>[f("删除")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1})])}}},[["__scopeId","data-v-e8357edc"]]);export{T as default};
