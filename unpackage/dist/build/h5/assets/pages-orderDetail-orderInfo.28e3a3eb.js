import{ah as e,p as a,U as l,k as s,o as t,c as n,w as u,g as o,b as i,q as r,f as p,t as c,j as d,D as v,a as x,h as f,F as m,d as y,z as k,v as g,u as h,J as _,A as b,a1 as j}from"./index-ffdd3f87.js";import{_ as F}from"./uni-card.e3f11ce9.js";import{o as w,c as M,v as C,x as I,r as D}from"./api.39a99923.js";import{_ as B,a as A}from"./uni-popup.9ebeac1f.js";import{_ as E}from"./addRecords.6dc0427f.js";import{_ as L}from"./abButton.3cf189b9.js";import"./abMiniButton.d5f2b05e.js";import"./dayjs.min.69427526.js";const N={__name:"orderInfo",setup(N){let P=e("orderId");const T=a({}),q=["正常辣","微辣","特辣"];w((async e=>{e.id&&(P=e.id);let a=await M({id:P});T.value=a[0];let l=await C({orderId:P||"dfs2345"});J.value=l}));const z=a(""),J=a([]);l((()=>{if(!s())try{document.getElementsByClassName("uni-page-head-btn")[0].style.display="none"}catch(e){}}));const O=a(null),R=async()=>{if(z.value)return O.value.open();let e=await I({orderId:P});console.log(e),z.value=e,O.value.open()},U=()=>{console.log(z.value),k({filePath:z.value,success:e=>{g({title:"保存成功",icon:"success",mask:!0}),O.value.close()},fail:e=>{console.log(e),h({title:"失败",content:e.errMsg,showCancel:!0,success:({confirm:e,cancel:a})=>{}}),O.value.close()}})};return(e,a)=>{const l=_("abEmpty"),k=D(b("uni-card"),F),g=j,h=D(b("uni-popup-dialog"),B),w=D(b("uni-popup"),A),M=o;return t(),n(M,null,{default:u((()=>[!T.value.isFinish&&T.value.takeMeal?(t(),i("div",{key:0,class:"px-[12px] pt-[12px] text-center"},[r("p",null,[p(" 订单正在准备中，您的取餐号是:"),r("span",{class:"text-text3 text-16 font-bold"},c(T.value.takeMeal),1)])])):d("",!0),v(s)()?(t(),i("div",{key:1,class:"p-[12px] px-[16px]"},[x(L,{icon:"link",onClick:R},{default:u((()=>[p("为此订单生成网址二维码")])),_:1})])):d("",!0),x(k,null,{default:u((()=>{var e,a;return[r("div",{class:"text-12"},[r("div",{class:"grid grid-cols-2"},[r("span",null,"订单名："+c(T.value.orderName),1),r("span",null,[p("订单状态："),r("span",{class:f(T.value.isFinish?"text-text5":"text-text3")},c(T.value.isFinish?"已完成":"未完成"),3)]),r("span",null,"口味："+c(q[T.value.taste-1]),1),T.value.desk?(t(),i("span",{key:0},"桌位："+c(T.value.desk),1)):d("",!0),r("span",null,"是否打包："+c(T.value.isPack?"打包":"未打包"),1),r("span",null,"是否有加菜："+c(T.value.isAddMenu?"有":"无"),1),r("span",null,"下单方式："+c(T.value.userOperation?"客户自助":"管理员"),1),r("span",null,[p("订单金额："),r("span",{class:"text-text3 text-14"},c(null==(e=T.value.totalMoney)?void 0:e.toFixed(2)),1)]),T.value.isFinish?(t(),i("span",{key:1},[p("实收金额："),r("span",{class:"text-text3 text-14"},c((T.value.actualMoney||T.value.totalMoney).toFixed(2)),1)])):d("",!0),r("span",null,"商品总数："+c(T.value.totalCount),1)]),r("p",null,"订单ID："+c(T.value.id),1),r("p",null,"创建时间："+c(T.value.showTime),1),r("p",{class:"text-16 text-center my-[12px]"},"商品明细清单"),(null==(a=T.value.orderDetail)?void 0:a.length)?(t(),i("div",{key:0},[r("ul",null,[r("li",{class:"grid grid-cols-4 text-center py-[4px] font-bold"},[r("span",null,"名称"),r("span",null,"单价"),r("span",null,"数量"),r("span",null,"小记")]),(t(!0),i(m,null,y(T.value.orderDetail,(e=>(t(),i("li",{key:e.id,class:"grid grid-cols-4 text-center py-[4px]",style:{"border-bottom":"1px solid var(--border_c)"}},[r("span",null,c(e.name),1),r("span",null,c(e.price.toFixed(2)),1),r("span",null,c(e.count),1),r("span",{class:"text-text3"},c((e.price*e.count).toFixed(2)),1)])))),128))])])):(t(),n(l,{key:1,text:"暂无数据"})),J.value.length>1?(t(),n(E,{key:2,recordsList:J.value},null,8,["recordsList"])):d("",!0)])]})),_:1}),x(w,{ref_key:"popup2",ref:O,type:"dialog"},{default:u((()=>[x(h,{title:"订单二维码",confirmText:"保存二维码",duration:2e3,"before-close":!0,onClose:a[0]||(a[0]=e=>O.value.close()),onConfirm:U},{default:u((()=>[r("div",{class:"flex justify-center w-full"},[x(g,{src:z.value,class:"w-full"},null,8,["src"])])])),_:1})])),_:1},512)])),_:1})}}};export{N as default};
